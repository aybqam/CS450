<?php
$host = 'your_host';
$username = 'your_username';
$password = 'your_password';
$database = 'your_database';

// Create a connection
$conn = new mysqli($host, $username, $password, $database);

// Check connection
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Create the ip_addresses table if it doesn't exist
$createTableQuery = "CREATE TABLE IF NOT EXISTS ip_addresses (
    id INT(11) AUTO_INCREMENT PRIMARY KEY,
    ip_address VARCHAR(45) NOT NULL
)";
$conn->query($createTableQuery);

// Obtain the IP address of the visitor
$ipAddress = $_SERVER['REMOTE_ADDR'];

// Check if the IP address already exists in the table
$stmt = $conn->prepare("SELECT * FROM ip_addresses WHERE ip_address = ?");
$stmt->bind_param("s", $ipAddress);
$stmt->execute();
$result = $stmt->get_result();

if ($result->num_rows > 0) {
    echo "IP address already exists in the table.";
} else {
    // Insert the IP address into the table
    $insertStmt = $conn->prepare("INSERT INTO ip_addresses (ip_address) VALUES (?)");
    $insertStmt->bind_param("s", $ipAddress);
    $insertStmt->execute();

    echo "IP address inserted into the table.";
}

$stmt->close();
$insertStmt->close();
$conn->close();
?>
